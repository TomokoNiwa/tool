<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Recipe Log - Data & Memo</title>
    <link rel="stylesheet" href="css/style.css">
    </head>
<body>

<h1>ğŸ³ My Recipe Log & Data Generator</h1>

<div class="container">
    <div class="editor">
        <h2>ãƒ¬ã‚·ãƒ”å…¥åŠ›</h2>
        
        <div class="form-group">
            <label>æ–™ç†å</label>
            <input type="text" id="recipeName" placeholder="ä¾‹ï¼šç©¶æ¥µã®è‚‰ã˜ã‚ƒãŒ" oninput="update()">
        </div>

        <div class="form-group">
            <label>ææ–™ãƒ»èª¿å‘³æ–™</label>
            <div id="ingredientList">
                <div class="ingredient-row">
                    <input type="text" placeholder="ææ–™/èª¿å‘³æ–™" class="ing-name" oninput="update()">
                    <input type="text" placeholder="åˆ†é‡" class="ing-amount" oninput="update()">
                </div>
            </div>
            <button onclick="addIngredient()">ï¼‹ ææ–™è¿½åŠ </button>
        </div>

        <div class="form-group">
            <label>æº€è¶³åº¦ï¼ˆâ˜…ï¼‰</label>
            <select id="rating" onchange="update()">
                <option value="5">â˜…â˜…â˜…â˜…â˜… (æœ€é«˜ï¼é»„é‡‘æ¯”)</option>
                <option value="4">â˜…â˜…â˜…â˜…â˜† (ãŠã„ã—ã„)</option>
                <option value="3">â˜…â˜…â˜…â˜†â˜† (æ™®é€š)</option>
                <option value="2">â˜…â˜…â˜†â˜†â˜† (è¦æ”¹å–„)</option>
            </select>
        </div>

        <div class="form-group">
            <label>æ”¹å–„ãƒ¡ãƒ¢</label>
            <textarea id="memo" rows="3" placeholder="æ¬¡ã¯ç ‚ç³–ã‚’æ§ãˆã‚ã«ã™ã‚‹ã€ãªã©" oninput="update()"></textarea>
        </div>

        <div class="form-group">
            <label>å‚è€ƒURL</label>
            <input type="url" id="refUrl" placeholder="https://..." oninput="update()">
        </div>
    </div>

    <div class="output-area">
        <h2>å‡ºåŠ›çµæœ</h2>
        
        <label>Markdown (äººé–“ç”¨ãƒ¡ãƒ¢)</label>
        <button class="copy-btn" onclick="copyText('md-output')">Markdownã‚’ã‚³ãƒ”ãƒ¼</button>
        <pre id="md-output"></pre>

        <label>JSON (ã‚·ã‚¹ãƒ†ãƒ ç”¨ãƒ‡ãƒ¼ã‚¿)</label>
        <button class="copy-btn" onclick="copyText('json-output')">JSONã‚’ã‚³ãƒ”ãƒ¼</button>
        <pre id="json-output" class="json-box"></pre>
    </div>
</div>

<script>
    function addIngredient() {
        const div = document.createElement('div');
        div.className = 'ingredient-row';
        div.innerHTML = `
            <input type="text" placeholder="ææ–™/èª¿å‘³æ–™" class="ing-name" oninput="update()">
            <input type="text" placeholder="åˆ†é‡" class="ing-amount" oninput="update()">
        `;
        document.getElementById('ingredientList').appendChild(div);
    }

    function update() {
        const name = document.getElementById('recipeName').value || 'ç„¡é¡Œã®ãƒ¬ã‚·ãƒ”';
        const url = document.getElementById('refUrl').value;
        const ratingNum = document.getElementById('rating').value;
        const ratingStars = 'â˜…'.repeat(ratingNum) + 'â˜†'.repeat(5 - ratingNum);
        const memo = document.getElementById('memo').value;
        
        const names = document.querySelectorAll('.ing-name');
        const amounts = document.querySelectorAll('.ing-amount');
        
        const ingredients = [];
        let ingMd = '';
        
        names.forEach((n, i) => {
            if (n.value) {
                ingredients.push({ item: n.value, amount: amounts[i].value });
                ingMd += `- ${n.value}: ${amounts[i].value}\n`;
            }
        });

        // Markdown ç”Ÿæˆ (URLã‚’æœ€å¾Œã«é…ç½®)
        const markdown = `# ${name}\n\n` +
            `## è©•ä¾¡: ${ratingStars}\n\n` +
            `### ææ–™ãƒ»èª¿å‘³æ–™\n${ingMd}\n` +
            `### ãƒ¡ãƒ¢\n${memo}\n\n` +
            (url ? `**å‚è€ƒ:** ${url}\n\n` : '') +
            `--- \n*Generated by My Recipe Log*`;

        // JSON ç”Ÿæˆ
        const jsonData = {
            title: name,
            rating: parseInt(ratingNum),
            ingredients: ingredients,
            memo: memo,
            url: url,
            updatedAt: new Date().toISOString().split('T')[0]
        };

        document.getElementById('md-output').innerText = markdown;
        document.getElementById('json-output').innerText = JSON.stringify(jsonData, null, 2);
    }

    function copyText(id) {
        const text = document.getElementById(id).innerText;
        navigator.clipboard.writeText(text).then(() => alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼'));
    }

    // åˆæœŸåŒ–
    update();
</script>

</body>
</html>